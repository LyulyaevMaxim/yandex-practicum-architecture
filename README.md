## Уровень 1: Проектирование
Для разбиения монолитного приложения на host + микрофронтенды выбран [Module Federation 2](https://module-federation.io/):
* в отличие от изначального Webpack Module Federation, эта версия непривязана к конкретному инструменту сборки - e.g., можно интегрировать Vite + Vite, Webpack + Vite.
* (в случае необходимости) поддерживает одновременную интеграцию микрофронтендов на разных фреймворках (e.g., react, vue, angular, svelte) - [офиц. примеры](https://github.com/module-federation/module-federation-examples)
* в отличие от Single-spa: в более активной разработке; начиная с лета 2024 [разница в количестве скачиваний](https://npmtrends.com/@module-federation/enhanced-vs-single-spa) основного пакета достигла x3

## Уровень 2: Структура

### Основное приложение "host"
Основное приложение-оркестратор - именно с ним напрямую взаимодействует пользователь.\
Часть внутренней логики приложения сгруппирована по DDD и вынесена в отдельные микрофронтенды.\
`host`:
* подключает в себя нужные части этих микрофронтендов через Module Federation 2
* (при необходимости) предоставляет микрофронтенду доступ к api и данным за пределами его ответственности: 
  * например, микрофронтенду `places` нужны данные авторизованного пользователя, но ни к чему знать как её получить; 
  * аналогично, если микрофронтенду нужен доступ к какому-то глобальному API (e.g., router), то host предоставляет доступ в соответствии с ожидаемым в микрофронтенде абстрактным интерфейсом нужного api

### Микрофронтенд "auth"
* регистрация нового пользователя
* login и logout
* аутентификация

```
/microfrontends/auth
  /src
    /*Глобальный store, хранит информацию о том авторизованы ли
      Если да, то что это за пользователь.
      Предоставляет контекст, который host инициализирует глобнльно. 
    */
    storeAuth.tsx
    /components
      /Register  // Компонент регистрации пользователя
      /Login     // Компонент входа пользователя
    /utils
      /useIsLoggedIn // хук, запускаемый хостом на старте приложения
      /useOnLogout // хук, возвращающий коллбэк для сброса активной сессии, который можно вызывать, например на клик по кнопке  
    /api
      apiAuth    // необходимое api: register, login, checkToken
  package.json   // Зависимости и скрипты микрофронтенда
  vite.config.js
```
Не имеет единой точки входа, наружу экспортируются: storeAuth, useIsLoggedIn, useOnLogout, компоненты Register, Login.

### Микрофронтенд "users"
* Получение и отображение информации о пользователях. 
* Редактирование информации пользователя.
```
/microfrontends/users
  /src
    /components
      /ProfileInfo  // Компонент отображения краткой информации о пользователе
      /EditProfilePopup  // Компонент для изменения данных пользователя
      /EditAvatarPopup   // Компонент для изменения аватара пользователя
    /api
      apiUsers   // необходимое api: getUserInfo, setUserInfo, setUserAvatar
  package.json   // Зависимости и скрипты микрофронтенда
  vite.config.js
```
Не имеет единой точки входа, наружу экспортируются: ProfileInfo, EditProfilePopup, EditAvatarPopup.

### Микрофронтенд "places"
Добавление/удаление/редактирование/отображение различных мест в виде карточек.
Т.к. архитектурные изменения на данном этапе касаются только фронтенда, 
то появляется расхождение в именовании: cards на бэке, places - на фронте.

```
/microfrontends/places
  /src
    /*Глобальный store, хранит актуальную информацию о местах, 
    отображаемых пользователю.
    Предоставляет контекст, который host инициализирует глобнльно.*/
    storePlaces.tsx
    /components
      // компонент отображения места в виде карточки
      // карточку можно лайкнуть, отредактировать, удалить
      /Place       
      /PlacesGrid  // Компонент отображения всех мест с помощью Place
      /AddPlacePopup // Компонент создания нового места  
    /api
      apiPlace    // необходимое api: getCardList, addCard, removeCard, changeLikeCardStatus
  package.json   // Зависимости и скрипты микрофронтенда
  vite.config.js
```
Не имеет единой точки входа, наружу экспортируются: storePlaces, PlacesGrid, AddPlacePopup.
Зависит от данных о авторизованном пользователе: доступ к ним есть в storeAuth, 
из которого можем читать данные через экспортируемый хук `useStoreAuth`, 
обращающийся к контексту микрофронтенда auth, проинициализированному в корне host'a.
